--To check all names in my data
--To chek the data types in my data
SELECT*
     SUM(transaction_qty*unit_price) AS Revenue,
FROM blight.coffee.shop
LIMIT 10;

----------------------------------------------

---Exploratory data Analysis....

---Checking number of cofee stores
SELECT DISTINCT store_location
FROM blight.coffee.shop;

---Checking number of product categories
SELECT DISTINCT product_category
FROM blight.coffee.shop;

---Checking number of product types
SELECT DISTINCT product_type
FROM blight.coffee.shop;

---Date and time functions
---Checking the earliest transation date
SELECT MIN (transaction_date) AS first_operating_date
FROM blight.coffee.shop;

---Checking the latest transation date
SELECT MAX (transaction_date) AS last_operating_sate
FROM blight.coffee.shop;

---Checking the earliest time
SELECT MIN (transaction_time) AS first_operating_time
FROM blight.coffee.shop;

---Checking the latest transation time
SELECT MAX (transaction_time) AS last_operating_time
FROM blight.coffee.shop;

------------------------------------------------------

SELECT transaction_date,
       
       DAYNAME (transaction_date) AS day_name,
        CASE 
          WHEN day_name IN ('Sat', 'Sun') THEN 'Weekend'
          ELSE 'Weekday'
       END AS day_classification,   
       
       MONTHNAME (transaction_date) AS month_name, 
       
       --transaction_time,
        CASE 
          WHEN transaction_time BETWEEN '06:00:00' AND '11:59:59' THEN 'Morning'
          WHEN transaction_time BETWEEN '12:00:00' AND '16:59:59' THEN 'Afternoon'
          WHEN transaction_time >= '17:00:00' THEN 'Evening'
       END AS time_bucket,
       
       Hour(transaction_time) AS hour_of_day,

       --categorical data
       store_location,
       product_category,
       product_detail,
       product_type,

       --ID's
       COUNT (DISTINCT transaction_id) AS Number_of_sales,

       --revenue calculation
       SUM(transaction_qty*unit_price) AS revenue   
       
FROM blight.coffee.shop
GROUP BY ALL;
